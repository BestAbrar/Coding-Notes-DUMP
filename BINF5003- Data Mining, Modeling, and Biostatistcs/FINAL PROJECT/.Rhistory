df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#1.
library(ggplot2)
# ggplot redundancy allows for variables to be called either globally or locally for instance:
ggplot(bCancer, aes(x=radius_mean, y = area_mean))+
geom_point(aes(color = diagnosis))+             #local aesthetic override
geom_smooth(se=FALSE)                           #inherits x and y but not color
bCancer <- read.csv("breastCancer.csv", header=T)
#1.
library(ggplot2)
# ggplot redundancy allows for variables to be called either globally or locally for instance:
ggplot(bCancer, aes(x=radius_mean, y = area_mean))+
geom_point(aes(color = diagnosis))+             #local aesthetic override
geom_smooth(se=FALSE)                           #inherits x and y but not color
#geom_smooth inherits x and y but not the 'color' variable that was defined inside
#(locally) in geom_point, this allows the smoothing line not to be colored
#This keeps code clean, organized and flexible
ggplot(bCancer,aes(x=smoothness_mean,y=compactness_mean))+
geom_point(aes(color=diagnosis))+
geom_smooth(method="lm", se =FALSE)+
labs(title="Mean Smoothness vs Compatness",
x="Mean Smoothness",
y="Mean Compactness")
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
ggplot(df, aes(x=word_count,y=..density..))+
geom_histogram()
ggplot(df, aes(x=unique_word_count,y=..density..))+
geom_histogram()
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
ggplot(df, aes(x=word_count,y=..density..))+
geom_histogram()
ggplot(df, aes(x=unique_word_count,y=..density..))+
geom_histogram()
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
library(ggplot2) # plotting
library(dplyr) # manipulation
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
ggplot(df, aes(x=word_count,y=..density..))+
geom_histogram()
ggplot(df, aes(x=unique_word_count,y=..density..))+
geom_histogram()
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
ggplot(df, aes(x=voted_up,y=unique_word_count))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="Average Mean Radius by Diagnosis",
x="Diagnosis", y="Average radius (mm)")
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="Average Mean Radius by Diagnosis",
x="voted_up", y="unique_word_count")
#'a) I would use a box plot (with additional violin plot to show density
#'distribution, they both compliment the shortcomings of each other), the data
#'is COMPARING the mean radius BETWEEN two CATAGORICAL
#'variables:'M' and 'B' while also showing the distribution and the standard
#'deviation between the two variables
library(ggplot2) # plotting
library(dplyr) # manipulation
library(tidyverse)
ggplot(bCancer, aes(x=diagnosis,y=radius_mean))+
geom_violin(aes(fill=diagnosis))+
geom_boxplot(width=0.1)+
labs(title="Average Mean Radius by Diagnosis",
x="Diagnosis", y="Average radius (mm)")
bCancer <- read.csv("breastCancer.csv", header=T)
#'a) I would use a box plot (with additional violin plot to show density
#'distribution, they both compliment the shortcomings of each other), the data
#'is COMPARING the mean radius BETWEEN two CATAGORICAL
#'variables:'M' and 'B' while also showing the distribution and the standard
#'deviation between the two variables
library(ggplot2) # plotting
library(dplyr) # manipulation
library(tidyverse)
ggplot(bCancer, aes(x=diagnosis,y=radius_mean))+
geom_violin(aes(fill=diagnosis))+
geom_boxplot(width=0.1)+
labs(title="Average Mean Radius by Diagnosis",
x="Diagnosis", y="Average radius (mm)")
#'b)I would use a scater plot to compare 2 continuous variables, I can then use
#'smooth to determine if there is a correlation between the two variables
ggplot(bCancer,aes(x=smoothness_mean,y=compactness_mean))+
geom_point(aes(color=diagnosis))+
geom_smooth(method="lm", se =FALSE)+
labs(title="Mean Smoothness vs Compatness",
x="Mean Smoothness",
y="Mean Compactness")
#based on the data, the correlation is significant (non-random), weak and positive between the continuous variables Mean smoothness and the Mean Compactness
#'C) The form of data needed for this plot is a dataframe, with variables
#''diagnosis, varibles(consisting of 'radius_mean' and 'texture_mean') and their
#'corresponding values
bCancerLong<- bCancer%>%
select(diagnosis,radius_mean,texture_mean) %>%
pivot_longer(cols = "radius_mean":"texture_mean",
names_to = "variables",
values_to = "values")
ggplot(bCancerLong, aes(x=diagnosis,y=values))+
geom_violin(aes(fill=diagnosis))+
facet_wrap(~variables)
#'d)
bCancerLongest<-bCancer %>%
select(diagnosis:symmetry_mean) %>%
pivot_longer(cols = "radius_mean":"symmetry_mean",
names_to = "variables",
values_to = "values")
ggplot(bCancerLongest, aes(x=values,y=..density..))+
geom_histogram(aes(fill=diagnosis),alpha=0.6, position = 'identity')+
labs(title='bCancer mean values distribution summary')+
facet_wrap(~variables,scales='free')
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
#Histogram of the date review was written
positive_reviews<-df %>%
filter(voted_up=="True")
negitive_reviews<-df %>%
filter(voted_up=="False")
ggplot(positive_reviews, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=diagnosis),alpha=0.6)
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
#Histogram of the date review was written
positive_reviews<-df %>%
filter(voted_up=="True")
negitive_reviews<-df %>%
filter(voted_up=="False")
ggplot(positive_reviews, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=diagnosis),alpha=0.6)
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
ggplot(positive_reviews, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6)
ggplot(positive_reviews, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=diagnosis),alpha=0.6, position = 'identity')
ggplot(positive_reviews, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity')
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity')
head(table1)
table1
table1 %>%
pivot_longer(cols = "year":"population",
names_to = "jimmy",
values_to = "number")
table1
table2
table3
# Spread across two tibbles
table4a  # cases
table4b  # population
head(table1)
table1
table1 %>%
pivot_longer(cols = "year":"population",
names_to = "jimmy",
values_to = "number")
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity')
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram()
ggplot(df, aes(x=str(created_date),y=..density..))+
geom_histogram()
ggplot(df, aes(x=created_date))+
geom_histogram()
ggplot(df, aes(x=unique_word_count))+
geom_histogram()
df$created_date <- as.Date(df$created_date)
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity')
print(df$created_date)
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
df$created_date <- as.Date(df$created_date)
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity')
df$created_date <- as.Date(df$created_date)
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity',binwidth = 7)
df$created_date <- as.Date(df$created_date)
print(max(df$created_date))
print(min(df$created_date))
df$created_date <- as.Date(df$created_date)
print(min(df$created_date))
print(max(df$created_date))
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity',binwidth = 7)
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point()+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
df$created_date <- as.Date(df$created_date)
print(min(df$created_date))
print(max(df$created_date))
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity',binwidth = 7)
ggplot(df, aes(x=created_date,y=..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity',binwidth = 7)+
scale_x_date(date_breaks = "1 month", date_labels = "%Y-%m")
#install.packages("uwot")
#install.packages("caret", dependencies = TRUE)
#install.packages("summarytools")
library(summarytools)
library(caret)
library(uwot)
library(ggplot2)
library(dplyr)
library(tidyverse)
df <- read.csv("GTA Vice_city(cleaned).csv", header = TRUE)
#data set variables and metrics
df$id <- as.character(df$id)
df$created_date <- as.Date(df$created_date)
df$author_last_played_date <- as.Date(df$author_last_played)
df <- df %>%
mutate(voted_up = ifelse(voted_up == "True",TRUE,FALSE)) %>%
mutate(steam_purchase = ifelse(steam_purchase == "True",TRUE,FALSE))
df_summary <- df %>%
select(-c(created,author_last_played,steam_purchase))
df_summary <- as.data.frame(dfSummary(df_summary))
write.csv(df_summary, "mydata.csv", row.names = FALSE)
#scater plot of Word count to unique_word_count
ggplot(df,aes(x=word_count,y=unique_word_count))+
geom_point(aes(colour = df$voted_up))+
geom_smooth(method="lm", se =FALSE)+
labs(title="Word count vs Unique word count",
x="word_count",
y="unique_word_count")
#box plot of unique word count and pos/neg review
ggplot(df, aes(x=voted_up,y=log(unique_word_count)))+
geom_violin(aes(fill=voted_up))+
geom_boxplot(width=0.1)+
labs(title="Log(Unique word count) vs Voted Up",
x="voted_up", y="unique_word_count")
pos_review <- df %>%
filter(df$voted_up==TRUE)
neg_review <- df %>%
filter(df$voted_up==FALSE)
print(mean(log(pos_review$unique_word_count)))
print(sd(log(pos_review$unique_word_count)))
print(mean(log(neg_review$unique_word_count)))
print(sd(log(neg_review$unique_word_count)))
qqnorm(log(neg_review$unique_word_count), main = "Normal Q-Q plot of log (unique word count)\n for voted_up FALSE",
xlab = "Theoretical Log(Unique Word Count)", ylab="Actual Log(Unique Word Count)")
qqline(log(neg_review$unique_word_count), col = "red")
qqnorm(log(pos_review$unique_word_count), main = "Normal Q-Q plot of log (unique word count)\n for voted_up TRUE",
xlab = "Theoretical Log(Unique Word Count)", ylab="Actual Log(Unique Word Count)")
qqline(log(pos_review$unique_word_count), col = "red")
OUWC_pos_review <- pos_review %>%
filter(unique_word_count==1)
print(nrow(OUWC_pos_review)/nrow(pos_review))
#Reviews are collected from 2023-06-27 to 2024-02-01
print(min(df$created_date))
print(max(df$created_date))
ggplot(df, aes(x=created_date, y = ..density..))+
geom_histogram(aes(fill=voted_up),alpha=0.6, position = 'identity',binwidth = 7)+
scale_x_date(date_breaks = "1 month", date_labels = "%Y-%m")+
ggtitle("Distribution of reviews by Date")
df_Dec <- df %>%
filter(created_date>="2023-12-01" & created_date<"2024-01-01")
df_Nov <-df %>%
filter(created_date>="2023-11-01" & created_date<"2023-12-01")
print(nrow(df_Dec)/nrow(df_Nov))
df_short <- df %>%
select(-c(author_last_played,voted_up,steam_purchase))
df_short <- df_short[ , 5:13]
cor_mat <- cor(df_short, use = "pairwise.complete.obs")
high_cor_idx <- findCorrelation(cor_mat, cutoff = 0.9)
colnames(df_short)[high_cor_idx]
df_short <- df_short %>%
select(-c(author_playtime_at_review, word_count))
pca_df <- prcomp(df_short, scale = TRUE)
#Number of PC
length(pca_df)
#There are 5 principal components
variance_df = pca_df$sdev^2
variance_df / sum(variance_df) -> prop_df
# plot variance in a scree plot
plot(prop_df,
xlab = "Principal Components",
ylab = "Proportion of Variance Explained",
ylim = c(0, 1))
#percentage variance for each PC
print((variance_df[1]+variance_df[2])/sum(variance_df))
ggplot(pca_df$x, aes(x = PC1, y = PC2)) +
geom_point(aes(colour = df$voted_up),alpha=0.7)+
labs(title="PCA analysis of Reviews with Voted-Up")
#5 variables most strongly contributing to the positive values in PC1?
loadings_pc1 <- pca_df$rotation[, "PC1"]
sorted_loadings_pc1 <- sort(abs(loadings_pc1), decreasing = TRUE)
print(head(sorted_loadings_pc1,n=5))
umap_res <- umap(df_short, n_neighbors = 30, min_dist = 0.1, metric = "cosine")
umap_df <- as.data.frame(umap_res)
umap_df$word_count <- df$word_count
umap_df$word_count <- df$unique_word_count
umap_df$group <- "NO"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 300] <- "Subgroup 1"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 175] <- "Subgroup 2"
umap_df$group[umap_df$word_count <= 700 &
umap_df$unique_word_count < 300] <- "Subgroup 3"
umap_df$group[umap_df$word_count <= 700 &
umap_df$unique_word_count > 300] <- "Subgroup 4"
umap_df$voted_up <- df$voted_up
ggplot(umap_df, aes(V1, V2)) +
geom_point(alpha = 0.6, colour = group)
View(umap_df)
umap_df$word_count <- df$word_count
umap_df$word_count <- df$unique_word_count
View(umap_df)
View(umap_df)
umap_df$word_count <- df$word_count
umap_df$unique_word_count <- df$unique_word_count
umap_df$group <- "NO"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 300] <- "Subgroup 1"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 175] <- "Subgroup 2"
umap_df$group[umap_df$word_count <= 700 &
umap_df$unique_word_count < 300] <- "Subgroup 3"
umap_df$group[umap_df$word_count <= 700 &
umap_df$unique_word_count > 300] <- "Subgroup 4"
umap_df$word_count <- df$word_count
umap_df$unique_word_count <- df$unique_word_count
umap_df$group <- "NO"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 300] <- "Subgroup 1"
umap_df$group[umap_df$word_count < 700 &
umap_df$unique_word_count < 175] <- "Subgroup 2"
umap_df$group[umap_df$word_count >= 700 &
umap_df$unique_word_count < 300] <- "Subgroup 3"
umap_df$group[umap_df$word_count >= 700 &
umap_df$unique_word_count > 300] <- "Subgroup 4"
umap_df$voted_up <- df$voted_up
ggplot(umap_df, aes(V1, V2)) +
geom_point(alpha = 0.6, colour = umap_df$group)
ggplot(umap_df, aes(V1, V2)) +
geom_point(alpha = 0.6, fill = umap_df$group)
ggplot(umap_df, aes(V1, V2)) +
geom_point(alpha = 0.6, color = umap_df$group)
ggplot(umap_df, aes(V1, V2)) +
geom_point(alpha = 0.6, aes (color = group))
