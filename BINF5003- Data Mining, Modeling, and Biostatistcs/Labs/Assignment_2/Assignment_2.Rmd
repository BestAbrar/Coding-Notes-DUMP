---
title: "Assignment 2 - Data Wrangling"
author: 'Abrar Faruque'
date: 'Oct 6th 2025'
output:
  pdf_document: default
  html_document: default
---

## Assignment 2 - Data Wrangling 

1. Create a vector v with all integers 0-30, and a vector w with every third integer in the same range (Hint: you will need the `seq()` function).

a) What is the difference in lengths of the vectors v and w? [0.25]
b) Create a new vector, v_square, with the square of elements at indices 3, 6, 7, 10, 15, 22, 23, 24, and 30 from the variable v. Hint: use indexing. Calculate the mean and median of the first five values from v_square. [0.5]
c) Create a boolean vector v_bool, indicating which vector v elements are bigger than 20. How many values are over 20? Hint: In R, TRUE = 1, and FALSE = 0, so you can use simple arithmetic to find this out. [1]

```{r}
v <- (0:30)
w <- seq(0,30,3)
print(v)
print(w)
#1a)
print(length(v)-length(w)) #the difference between length v and w is 20
#1b)
v_square <- c(v[3],v[6],v[7],v[10],v[15],v[22],v[23],v[24],v[30])
v_square <- v_square*v_square
print(v_square)
print(mean(v_square[1:5])) #mean value of first 5 elements is 68.4
print(median(v_square[1:5])) #median value of first 5 elements is 36

#1c)
v_bool <- v>20
sum(v_bool) # there are 10 numbers greater than 20 in v_bool
```


2. Use the `CO2` dataset that pre-exists in R. Use the code below to get information about this dataset.
```{r}
library(dplyr)
library(tidyverse)
data(CO2)
```

a) Create a summary table, grouped by the plant and the treatment, that includes the mean, standard deviation, and number of data rows. Is this dataset balanced (i.e., are there the same number of observations for each treatment)? [0.5]
b) Using the summarised table from part a), reorder the table from largest to smallest mean uptake. What plant and treatment has the highest and lowest mean uptake? [0.5]
c) Tidy up the data by making the dataset longer, re-formatting the ambient concentration and uptake into a new column called `measurement` with the values in a new column called `values`. Call this new dataset `CO2_long`. What do you notice about the average ambient concentration, as measured for each treatment group (i.e., grouped by plant, treatment, and the measurement)? [1]
d) Using this new longer format dataset as created in c), filter cases where the treatment is nonchilled, and the measurement is uptake. Then, add a new column called `values2`, and change the uptake measurement by a multiple of 1.3. Save this into a new object called CO2_new. [1]
e) Compare your `CO2_new` with the object below `CO2_new2`. Why are these two objects different? What does this tell you about this new function `ifelse()`? That is, how does `ifelse()` work? Hint: answer in terms of the arguments in this function. [1]
```{r}
#2a)
CO2_summary_table <- CO2 %>% 
  group_by(Plant,Treatment) %>% 
  summarise(
            mean_conc = mean(conc),
            mean_uptake = mean(uptake),
            SD_conc = sd(conc),
            SD_uptake = sd(uptake),
            nrow_conc = length(conc),
            nrow_uptake = length(uptake),
            .groups = "keep"
  )
print(CO2_summary_table)
#Yes, dataset is balanced; all plants and treatments have 7 observations each
#2b)
CO2_summary_table_ordered <- CO2_summary_table %>% 
  filter (mean_uptake==max(mean_uptake))

print(c(head(CO2_summary_table_ordered,1)$Plant,head(CO2_summary_table_ordered,1)$Treatment))
print(c(tail(CO2_summary_table_ordered,1)$Plant,tail(CO2_summary_table_ordered,1)$Treatment))
#Treatment and plant type (Qn1, nonchilled and Mc1,chilled) with highest and lowest mean
#uptake respectively

#2c)
CO2_long <- CO2 %>% 
  pivot_longer(cols = "conc":"uptake",
               names_to = "measurement",
               values_to = "values")
print(CO2_long)

CO2_long_summary <- CO2_long%>% 
  group_by(Plant,Treatment,measurement) %>% 
  summarise(
            mean_measurement = mean(values),
            SD_measurement = sd(values),
            nrow_values = length(values),
            .groups = "keep"
  )
print(CO2_long_summary)
#ambient concentration stays consistent regardless of plant or treatment,
#mean concentration is 435.00000 with standard deviation of 317.726297

#2d
CO2_new <- CO2_long %>% 
  filter(
    Treatment == 'nonchilled', measurement == 'uptake'
  )
CO2_new$values2 <- CO2_new$values*1.3

#2e
CO2_new2 <- CO2_long %>% 
  mutate(values2 = ifelse(Treatment == "nonchilled" & measurement == "uptake",
                          values * 1.3,
                          values))
#CO2_new2 includes the both 'chilled' and 'nonchilled' treatment types and only applys the
#1.3 x multiplier to only the 'nonchilled' objects, CO2_new only contains plant
#that haven't been chilled
#'ifelse' is a conditional function that checks if conditional argument 'Treatment
#'== "nonchilled" & (and) measurement == "uptake", if this is true than perform the 
#'TRUE argument which is values * 1.3, 'else' do the FALSE argument which is simply
#'add value unchanged
```


