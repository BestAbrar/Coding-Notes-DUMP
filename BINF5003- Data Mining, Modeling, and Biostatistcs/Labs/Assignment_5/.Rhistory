breaks = seq(0, 10, length.out = 10),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 5, length.out = 5),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 5, length.out = 1),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 1, length.out = 1),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 2, length.out = 2),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 2, length.out = 20),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 2, length.out = 50),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 10, length.out = 50),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 50, length.out = 50),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
1
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
breaks = seq(0, 10, length.out = 50),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
scaled_matrix <- apply(top_10_matrix, 2, function(x) {
(x - min(x)) / (max(x) - min(x)) * 10
})
library(pheatmap)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
scaled_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
scaled_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
top_10_matrix
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 4,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
breaks = seq(0, 10, length.out = 10),
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
breaks = seq(0, 10, length.out = 100),
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
breaks = seq(0, 10, length.out = 100),
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
library(pheatmap)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
library(grid)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
grid.text("Sample", x=-0.07, rot=90, gp=gpar(fontsize=16))
library(pheatmap)
library(grid)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
grid.text("Sample", x=-0.07, rot=90, gp=gpar(fontsize=16))
library(pheatmap)
library(grid)
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
setHook("grid.newpage", NULL, "replace")
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
grid.text("Sample", x=-0.07, rot=90, gp=gpar(fontsize=16))
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
setHook("grid.newpage", NULL, "replace")
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
grid.text("Sample", x=0.07, rot=90, gp=gpar(fontsize=16))
library(pheatmap)
library(grid)
setHook("grid.newpage", function() pushViewport(viewport(x=1,y=1,width=0.9, height=0.9, name="vp", just=c("right","top"))), action="prepend")
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
setHook("grid.newpage", NULL, "replace")
grid.text("Attribute", y=-0.07, gp=gpar(fontsize=16))
grid.text("Sample", x=-0.07, rot=90, gp=gpar(fontsize=16))
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
library(pheatmap)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
library(pheatmap)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
bCancer <- read.csv("breastCancer.csv", header = T)
pca_bCancer <- prcomp(bCancer[ , 3:32], scale = TRUE)
length(pca_bCancer$sdev)
#there are 30 principal components
variance_bCancer = pca_bCancer$sdev^2
# proportion variance
variance_bCancer / sum(variance_bCancer) -> prop_bCancer
# plot variance in a scree plot
plot(prop_bCancer,
xlab = "Principal Components",
ylab = "Proportion of Variance Explained",
ylim = c(0, 1))
#percentage variance for each PC
print((variance_bCancer[1]+variance_bCancer[2])/sum(variance_bCancer))
#'first and second component make up 63.2% of the total variance (explain 63.2% of
#'the variance)
library(ggplot2)
pca_bCancer$diagnosis = bCancer$diagnosis
ggplot(pca_bCancer$x, aes(x = PC1, y = PC2)) +
geom_point(aes(colour = pca_bCancer$diagnosis))+
labs(title="PCA analysis of bCancer with Diagnosis")
loadings_pc1 <- pca_bCancer$rotation[, "PC1"]
sorted_loadings_pc1 <- sort(abs(loadings_pc1), decreasing = TRUE)
print(head(sorted_loadings_pc1,n=5))
#'the 5 variables most strongly contributing to the positive values in PC1 are:
#'1. concave.points_mean
#'2. concavity_mean
#'3. concave.points_worst
#'4. compactness_mean
#'5. perimeter_worst
#'in order from greatest to least
library(pheatmap)
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
library(pheatmap)
library(RColorBrewer)
# Top 10 variables
ncol <- bCancer[, 3:32]
standard_deviations <- apply(ncol, 2, sd)^2
top10_names <- names(head(sort(standard_deviations, decreasing = TRUE),n=10))
# Extract top 10
top_10 <- bCancer[, top10_names]
rownames(top_10) <- rownames(bCancer)
top_10_matrix <- as.matrix(top_10)
# Row annotation
diagnosis_df <- data.frame(diagnosis = bCancer$diagnosis)
rownames(diagnosis_df) <- rownames(top_10_matrix)
# Colors
anno_colors <- list(
diagnosis = c(B = "skyblue", M = "red")
)
p <- pheatmap(
top_10_matrix,
col = brewer.pal(10, 'RdYlGn'),
scale = "column",
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
annotation_row = diagnosis_df,
annotation_colors = anno_colors,
cutree_cols = 2,
cutree_rows = 3,
main = "Heatmap of 10 most variable Attributes"
)
